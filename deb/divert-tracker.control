Section: dotfiles
Priority: optional
Standards-Version: 4.3.0

Package: divert-tracker
Version: 20250517.0
Maintainer: none
Depends: bash, dpkg
Architecture: all
Description: Disable Tracker services via dpkg-divert
Replaces: tracker-divert
Breaks: tracker-divert

File: postinst
 #!/bin/bash
 divert_file() {
   dpkg-divert --rename --add --divert "$1.bak" "$1"
   mkdir -p -m 0755 "$(dirname "$1")"
   ln -sf /dev/null "$1"
 }
 divert_file /etc/xdg/autostart/localsearch-3.desktop
 divert_file /etc/xdg/autostart/tracker-miner-fs-3.desktop
 divert_file /usr/bin/localsearch
 divert_file /usr/bin/tracker3
 divert_file /usr/lib/systemd/user/localsearch-3.service
 divert_file /usr/lib/systemd/user/localsearch-control-3.service
 divert_file /usr/lib/systemd/user/localsearch-writeback-3.service
 divert_file /usr/lib/systemd/user/tracker-extract-3.service
 divert_file /usr/lib/systemd/user/tracker-miner-fs-3.service
 divert_file /usr/lib/systemd/user/tracker-miner-fs-control-3.service
 divert_file /usr/lib/systemd/user/tracker-writeback-3.service
 divert_file /usr/libexec/localsearch-3
 divert_file /usr/libexec/localsearch-control-3
 divert_file /usr/libexec/localsearch-writeback-3
 divert_file /usr/libexec/tracker-extract-3
 divert_file /usr/libexec/tracker-miner-fs-3
 divert_file /usr/libexec/tracker-miner-fs-control-3
 divert_file /usr/libexec/tracker-writeback-3

File: prerm
 #!/bin/bash
 divert_undo() {
   if [[ -f "$1.bak" || "$1" -ef /dev/null ]]; then
     rm -f "$1"
   fi
   dpkg-divert --rename --remove "$1"
 }
 divert_undo /etc/xdg/autostart/localsearch-3.desktop
 divert_undo /etc/xdg/autostart/tracker-miner-fs-3.desktop
 divert_undo /usr/bin/localsearch
 divert_undo /usr/bin/tracker3
 divert_undo /usr/lib/systemd/user/localsearch-3.service
 divert_undo /usr/lib/systemd/user/localsearch-control-3.service
 divert_undo /usr/lib/systemd/user/localsearch-writeback-3.service
 divert_undo /usr/lib/systemd/user/tracker-extract-3.service
 divert_undo /usr/lib/systemd/user/tracker-miner-fs-3.service
 divert_undo /usr/lib/systemd/user/tracker-miner-fs-control-3.service
 divert_undo /usr/lib/systemd/user/tracker-writeback-3.service
 divert_undo /usr/libexec/localsearch-3
 divert_undo /usr/libexec/localsearch-control-3
 divert_undo /usr/libexec/localsearch-writeback-3
 divert_undo /usr/libexec/tracker-extract-3
 divert_undo /usr/libexec/tracker-miner-fs-3
 divert_undo /usr/libexec/tracker-miner-fs-control-3
 divert_undo /usr/libexec/tracker-writeback-3
